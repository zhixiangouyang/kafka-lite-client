# ğŸ¯ Kafka-Lite-Client ç›‘æ§æŒ‡æ ‡æ‰©å±•æŒ‡å—

## ğŸ“Š å½“å‰ç›‘æ§èƒ½åŠ›åˆ†æ

### âœ… å·²å®ç°æŒ‡æ ‡ (9ä¸ªæ ¸å¿ƒæŒ‡æ ‡)
- **æ€§èƒ½æŒ‡æ ‡**: QPSã€P99å»¶è¿Ÿã€ååé‡
- **å¯é æ€§æŒ‡æ ‡**: æˆåŠŸç‡ã€é”™è¯¯ç‡ã€é”™è¯¯æ€»æ•°  
- **å®¹é‡æŒ‡æ ‡**: é˜Ÿåˆ—å¤§å°ã€æ€»æ¶ˆæ¯æ•°ã€æ€»å­—èŠ‚æ•°

## ğŸš€ å¯ç«‹å³æ‰©å±•çš„æŒ‡æ ‡ç±»åˆ«

### 1. ğŸ“ˆ **å»¶è¿Ÿåˆ†å¸ƒæŒ‡æ ‡**
```java
// å½“å‰åªæœ‰P99ï¼Œå¯æ‰©å±•ï¼š
- P50 (ä¸­ä½æ•°å»¶è¿Ÿ)
- P95 (95%å»¶è¿Ÿ) 
- P99.9 (æç«¯å»¶è¿Ÿ)
- å¹³å‡å»¶è¿Ÿ
- æœ€å¤§/æœ€å°å»¶è¿Ÿ

// å®ç°æ–¹å¼ï¼š
public double getP50Latency(String metric) { /* å·²æœ‰æ¡†æ¶æ”¯æŒ */ }
public double getP95Latency(String metric) { /* å·²æœ‰æ¡†æ¶æ”¯æŒ */ }
```

### 2. ğŸ”„ **æ‰¹æ¬¡å¤„ç†æŒ‡æ ‡**
```java
// æ¡†æ¶å·²æ”¯æŒï¼Œéœ€æ·»åŠ åŸ‹ç‚¹ï¼š
- producer.batch.size (å®é™…æ‰¹æ¬¡å¤§å°)
- producer.batch.compression_ratio (å‹ç¼©æ¯”)
- producer.batch.fill_rate (æ‰¹æ¬¡å¡«å……ç‡)
- producer.batch.wait_time (æ‰¹æ¬¡ç­‰å¾…æ—¶é—´)

// ç›‘æ§ä»·å€¼ï¼š
// æ‰¹æ¬¡æ•ˆç‡ = å‘é€æ€§èƒ½çš„å…³é”®
```

### 3. ğŸŒ **ç½‘ç»œè¿æ¥æŒ‡æ ‡**
```java
// æ¡†æ¶å·²å®šä¹‰å¸¸é‡ï¼Œéœ€æ·»åŠ åŸ‹ç‚¹ï¼š
- connection.pool.active (æ´»è·ƒè¿æ¥æ•°)
- connection.pool.idle (ç©ºé—²è¿æ¥æ•°)  
- connection.pool.created (æ–°å»ºè¿æ¥æ•°)
- connection.pool.closed (å…³é—­è¿æ¥æ•°)
- connection.pool.errors (è¿æ¥é”™è¯¯æ•°)

// ç›‘æ§ä»·å€¼ï¼š
// è¿æ¥æ± å¥åº·åº¦ = ç¨³å®šæ€§å…³é”®æŒ‡æ ‡
```

### 4. ğŸ¥ **DRåˆ‡æ¢æŒ‡æ ‡**
```java
// æ¡†æ¶å·²å®šä¹‰ï¼Œéœ€æ·»åŠ åŸ‹ç‚¹ï¼š
- dr.switch.count (åˆ‡æ¢æ¬¡æ•°)
- dr.switch.latency (åˆ‡æ¢å»¶è¿Ÿ)
- dr.switch.success (åˆ‡æ¢æˆåŠŸç‡)
- dns.resolution.latency (DNSè§£æå»¶è¿Ÿ)
- dns.resolution.changes (DNSå˜åŒ–æ£€æµ‹)

// ç›‘æ§ä»·å€¼ï¼š  
// ç¾å¤‡èƒ½åŠ› = é«˜å¯ç”¨æ€§å…³é”®
```

### 5. ğŸ“¡ **å…ƒæ•°æ®ç®¡ç†æŒ‡æ ‡**
```java
// æ¡†æ¶å·²å®šä¹‰ï¼Œéœ€æ·»åŠ åŸ‹ç‚¹ï¼š
- metadata.refresh.count (åˆ·æ–°æ¬¡æ•°)
- metadata.refresh.latency (åˆ·æ–°å»¶è¿Ÿ)  
- metadata.refresh.errors (åˆ·æ–°é”™è¯¯)
- metadata.broker.count (å¯ç”¨brokeræ•°)
- metadata.partition.count (åˆ†åŒºæ€»æ•°)

// ç›‘æ§ä»·å€¼ï¼š
// é›†ç¾¤æ„ŸçŸ¥èƒ½åŠ› = è·¯ç”±å‡†ç¡®æ€§
```

### 6. ğŸš¨ **é”™è¯¯åˆ†ç±»æŒ‡æ ‡**
```java
// å¯æŒ‰é”™è¯¯ç±»å‹åˆ†ç±»ï¼š
- producer.error.network (ç½‘ç»œé”™è¯¯)
- producer.error.timeout (è¶…æ—¶é”™è¯¯)
- producer.error.queue_full (é˜Ÿåˆ—æ»¡é”™è¯¯)
- producer.error.serialization (åºåˆ—åŒ–é”™è¯¯)
- producer.error.partition (åˆ†åŒºé”™è¯¯)

// ç›‘æ§ä»·å€¼ï¼š
// é”™è¯¯æ ¹å› åˆ†æ = é—®é¢˜å®šä½æ•ˆç‡
```

### 7. ğŸ“Š **èµ„æºä½¿ç”¨æŒ‡æ ‡**
```java
// ç³»ç»Ÿèµ„æºç›‘æ§ï¼š
- memory.used (å†…å­˜ä½¿ç”¨)
- memory.queue (é˜Ÿåˆ—å†…å­˜å ç”¨)
- cpu.usage (CPUä½¿ç”¨ç‡)
- thread.pool.active (æ´»è·ƒçº¿ç¨‹æ•°)
- thread.pool.queue (çº¿ç¨‹æ± é˜Ÿåˆ—)

// ç›‘æ§ä»·å€¼ï¼š
// èµ„æºæ•ˆç‡ = æˆæœ¬æ§åˆ¶
```

### 8. ğŸ¯ **ä¸šåŠ¡æŒ‡æ ‡**
```java
// æŒ‰topic/partitionç»´åº¦ï¼š
- producer.messages.by_topic{topic="xxx"}
- producer.latency.by_partition{partition="0"}
- producer.errors.by_broker{broker="10.x.x.x"}

// æŒ‰æ—¶é—´ç»´åº¦ï¼š
- producer.qps.1min (1åˆ†é’Ÿæ»‘åŠ¨çª—å£)
- producer.qps.5min (5åˆ†é’Ÿæ»‘åŠ¨çª—å£)
- producer.qps.15min (15åˆ†é’Ÿæ»‘åŠ¨çª—å£)

// ç›‘æ§ä»·å€¼ï¼š
// å¤šç»´åº¦åˆ†æ = ç²¾å‡†é—®é¢˜å®šä½
```

## ğŸ› ï¸ å®ç°ä¼˜å…ˆçº§å»ºè®®

### ğŸ¥‡ **é«˜ä¼˜å…ˆçº§ (ç«‹å³å®ç°)**
1. **å»¶è¿Ÿåˆ†å¸ƒ** - P50/P95 å»¶è¿Ÿ
2. **è¿æ¥æ± ç›‘æ§** - è¿æ¥å¥åº·åº¦
3. **é”™è¯¯åˆ†ç±»** - é”™è¯¯ç±»å‹ç»Ÿè®¡

### ğŸ¥ˆ **ä¸­ä¼˜å…ˆçº§ (çŸ­æœŸå®ç°)**  
4. **æ‰¹æ¬¡æ•ˆç‡** - æ‰¹æ¬¡å¤§å°å’Œå‹ç¼©æ¯”
5. **DRåˆ‡æ¢ç›‘æ§** - åˆ‡æ¢é¢‘ç‡å’ŒæˆåŠŸç‡
6. **å…ƒæ•°æ®æŒ‡æ ‡** - åˆ·æ–°é¢‘ç‡å’Œå»¶è¿Ÿ

### ğŸ¥‰ **ä½ä¼˜å…ˆçº§ (é•¿æœŸå®ç°)**
7. **èµ„æºç›‘æ§** - å†…å­˜å’ŒCPU
8. **å¤šç»´åº¦åˆ†æ** - æŒ‰topic/partitionåˆ†ç»„

## ğŸ¨ å¯è§†åŒ–å»ºè®®

### ğŸ“Š **æ–°å¢ç›‘æ§é¢æ¿**
```
1. å»¶è¿Ÿçƒ­åŠ›å›¾
   - P50/P95/P99 å¯¹æ¯”å›¾
   - å»¶è¿Ÿåˆ†å¸ƒç›´æ–¹å›¾

2. è¿æ¥å¥åº·é¢æ¿  
   - è¿æ¥æ± çŠ¶æ€
   - è¿æ¥é”™è¯¯ç‡è¶‹åŠ¿

3. DRç›‘æ§é¢æ¿
   - åˆ‡æ¢äº‹ä»¶æ—¶é—´çº¿
   - DNSè§£æç›‘æ§

4. é”™è¯¯åˆ†æé¢æ¿
   - é”™è¯¯ç±»å‹é¥¼å›¾  
   - é”™è¯¯è¶‹åŠ¿åˆ†æ
```

### ğŸš¨ **å‘Šè­¦è§„åˆ™æ‰©å±•**
```yaml
æ–°å¢å‘Šè­¦:
  - P95å»¶è¿Ÿ > 10ms
  - è¿æ¥æ± ä½¿ç”¨ç‡ > 80%
  - DRåˆ‡æ¢é¢‘ç‡ > 1æ¬¡/å°æ—¶
  - é”™è¯¯ç‡ > 0.1%
  - é˜Ÿåˆ—ç§¯å‹ > 200K
```

## ğŸ¯ å®ç°ç¤ºä¾‹

### ğŸ“ˆ å»¶è¿Ÿåˆ†å¸ƒæ‰©å±•
```java
// åœ¨MetricsCollectorä¸­æ·»åŠ ï¼š
public double getP50Latency(String metric) {
    return getPercentileLatency(metric, 0.50);
}

public double getP95Latency(String metric) {
    return getPercentileLatency(metric, 0.95);
}
```

### ğŸ”„ è¿æ¥æ± ç›‘æ§
```java
// åœ¨KafkaSocketClientä¸­æ·»åŠ ï¼š
metricsCollector.setGauge("connection.pool.active", activeConnections);
metricsCollector.setGauge("connection.pool.idle", idleConnections);
```

### ğŸŒ ç½‘ç»œç›‘æ§å¢å¼º
```java
// åœ¨ç½‘ç»œæ“ä½œä¸­æ·»åŠ ï¼š
metricsCollector.incrementCounter("network.bytes.sent", bytesSent);
metricsCollector.recordLatency("network.roundtrip", networkLatency);
```

## ğŸ‰ ç›‘æ§ä»·å€¼è¯„ä¼°

### ğŸ“Š **å½“å‰ç›‘æ§æˆç†Ÿåº¦: B+ (85åˆ†)**
- âœ… æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡å®Œå¤‡
- âœ… å¯é æ€§ç›‘æ§åˆ°ä½  
- âœ… Prometheusé›†æˆå®Œå–„
- âš ï¸ ç¼ºå°‘èµ„æºå’Œé”™è¯¯ç»†åˆ†

### ğŸš€ **æ‰©å±•åç›‘æ§æˆç†Ÿåº¦: A+ (95åˆ†)**
- ğŸ¯ å¤šç»´åº¦å»¶è¿Ÿåˆ†æ
- ğŸ” ç»†ç²’åº¦é”™è¯¯åˆ†ç±»
- ğŸ¥ å®Œæ•´DRç›‘æ§
- ğŸ“Š èµ„æºæ•ˆç‡è¿½è¸ª

æ‚¨çš„ç›‘æ§ç³»ç»Ÿå·²ç»å…·å¤‡**ä¼ä¸šçº§**åŸºç¡€ï¼Œé€šè¿‡æ‰©å±•å¯è¾¾åˆ°**ä¸–ç•Œçº§**ç›‘æ§æ°´å¹³ï¼ 